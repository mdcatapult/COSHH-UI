<div>
    <header>
        <img class="mdc-logo" src="assets/mdc-logo-blue-small.png">
        <mat-toolbar class="coshh-toolbar">
            <span>COSHH Inventory </span>
            <div class="add-chemical">
                <app-add-chemical
                        [labs]="labFilterValues"
                        [projectSpecific]="projectSpecific"
                        (onChemicalAdded)="onChemicalAdded($event)"
                ></app-add-chemical>
            </div>

            <span class="spacer"></span>

            <div class="toolbar-controls-container">

                <div class="filter-control">
                    <mat-form-field className="filter-select" appearance="outline">
                        <mat-label>Filter by lab</mat-label>
                        <mat-select required [formControl]="labFilterControl">
                            <mat-option *ngFor="let lab of labFilterValues" [value]="lab">{{lab}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="filter-control">
                    <mat-form-field className="filter-select" appearance="outline">
                        <mat-label>Filter by cupboard</mat-label>
                        <mat-select required [formControl]="cupboardFilterControl">
                            <mat-option *ngFor="let cupboard of cupboardFilterValues" [value]="cupboard">{{cupboard}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="filter-control">
                    <mat-form-field appearance="outline">
                        <mat-label>Filter by expiry</mat-label>
                        <mat-select required [formControl]="expiryFilterControl">
                            <mat-option *ngFor="let expiry of expiryFilterValues" [value]="expiry">{{expiry}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="filter-control">
                    <mat-form-field appearance="outline">
                        <mat-label>Filter by hazard</mat-label>
                        <mat-select required [formControl]="hazardFilterControl">
                            <mat-option *ngFor="let hazard of hazardFilterValues" [value]="hazard">{{hazard}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>


                <div class="filter-control">
                    <mat-form-field appearance="outline">
                        <mat-label>Project specific?</mat-label>
                        <mat-select required [formControl]="projectFilterControl">
                            <mat-option *ngFor="let project of projectFilterValues" [value]="project">{{project}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="filter-control">
                    <mat-form-field appearance="outline">
                        <mat-label>Name / Chem no</mat-label>
                        <input type="text"
                               placeholder="Type to search..."
                               aria-label="Search"
                               matInput
                               [formControl]="searchControl"
                               [matAutocomplete]="auto">
                        <mat-autocomplete #auto="matAutocomplete">
                            <mat-option *ngFor="let option of searchOptions | async | slice : 0 : 10" [value]="option">
                                {{option}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                </div>
            </div>

            <div class="filter-control archive-checkbox-container">
                <mat-checkbox
                        class="coshh-checkbox"
                        [formControl]="toggleArchiveControl"
                        color="primary">Display archived chemicals
                </mat-checkbox>
                <mat-checkbox
                        class="coshh-checkbox"
                        [(ngModel)]="freezeColumns"
                        color="primary">Freeze 'Name' and 'CAS' columns
                </mat-checkbox>
            </div>

        </mat-toolbar>
    </header>

    <br />

    <table mat-table [dataSource]="tableData"
           matSort (matSortChange)="announceSortChange($event)"
           class="mat-elevation-z8">

        <ng-container matColumnDef="casNumber">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by number">
                CAS no.
            </th>
            <td mat-cell *matCellDef="let element"> {{element.casNumber}} </td>
        </ng-container>

        <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by name">
                Chemical Name
            </th>
            <td mat-cell *matCellDef="let element"> {{element.name}} </td>
        </ng-container>

        <ng-container matColumnDef="hazards">
            <th mat-header-cell *matHeaderCellDef>
                Hazards
            </th>
            <td mat-cell *matCellDef="let chemical">
                <img *ngIf="!chemical.hazards || !chemical.hazards.length" class="img-responsive hazard"
                     src="assets/unknown.jpg" alt="Unknown" title="Unknown">

                <ul>
                    <li *ngFor="let hazard of chemical.hazardList">
                        <img *ngIf="hazard.activated" class="img-responsive hazard"
                             [src]="getHazardPicture(hazard.title)" [alt]="hazard.title" [title]="hazard.title">
                    </li>
                </ul>
            </td>
        </ng-container>

        <ng-container matColumnDef="location">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by location">
                Location
            </th>
            <td mat-cell *matCellDef="let element"> {{element.location}} </td>
        </ng-container>

        <ng-container matColumnDef="cupboard">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by cupboard">
                Cupboard
            </th>
            <td mat-cell *matCellDef="let element"> {{element.cupboard}} </td>
        </ng-container>

        <ng-container matColumnDef="chemicalNumber">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by chemical number">
                Chemical Number
            </th>
            <td mat-cell *matCellDef="let element"> {{element.chemicalNumber}} </td>
        </ng-container>

        <ng-container matColumnDef="matterState">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by state">
                State
            </th>
            <td mat-cell *matCellDef="let element"> {{element.matterState}} </td>
        </ng-container>

        <ng-container matColumnDef="quantity">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by quantity">
                Quantity
            </th>
            <td mat-cell *matCellDef="let element"> {{element.quantity}} </td>
        </ng-container>

        <ng-container matColumnDef="added">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by added date">
                Added
            </th>
            <td mat-cell *matCellDef="let element"> {{element.added | DateTimeFormat}} </td>
        </ng-container>

        <ng-container matColumnDef="expiry">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by expiry">
                Expiry
            </th>
            <td mat-cell *matCellDef="let element"> {{element.expiry | DateTimeFormat}} </td>
        </ng-container>

        <ng-container matColumnDef="safetyDataSheet">
            <th mat-header-cell *matHeaderCellDef>
                SDS
            </th>
            <td mat-cell *matCellDef="let element"> {{element.safetyDataSheet}} </td>
        </ng-container>

        <ng-container matColumnDef="coshhLink">
            <th mat-header-cell *matHeaderCellDef>
                COSHH
            </th>
            <td mat-cell *matCellDef="let element"> {{element.coshhLink}} </td>
        </ng-container>

        <ng-container matColumnDef="storageTemp">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by storage temperature">
                Storage Temp.
            </th>
            <td mat-cell *matCellDef="let element"> {{element.storageTemp}} </td>
        </ng-container>

        <ng-container matColumnDef="projectSpecific">
            <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by project">
                Project Specific?
            </th>
            <td mat-cell *matCellDef="let element"> {{element.projectSpecific}} </td>
        </ng-container>

        <ng-container matColumnDef="archive">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let chemical" class="coshh-archive-cell">
                <button
                    matTooltip="Archive this chemical"
                    matTooltipPosition="above"
                    class="archive-button"
                    mat-mini-fab
                    color="warn"
                    (click)="archive(chemical)"
                >
                    <mat-icon>delete</mat-icon>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
